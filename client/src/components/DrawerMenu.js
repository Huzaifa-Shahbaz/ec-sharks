import React, { useEffect, useRef, useState } from 'react';
import CrossIcon from '../assets/images/icons/cross-icon-2.png'


const DrawerMenu = ({ drawerOpened, setDrawerOpened }) => {

    const drawerRef = useRef()
    const [copied, setCopied] = useState(false)
    const currentUrl = window.location.href;


    const copyLink = async () => {
        try {
            await navigator.clipboard.writeText(currentUrl);
            setCopied(true);
        } catch (err) {
            const textArea = document.createElement('textarea');
            textArea.value = currentUrl;
            document.body.appendChild(textArea);
            textArea.select();
            document.execCommand('copy');
            document.body.removeChild(textArea);
            setCopied(true);
        }
    };

    useEffect(() => {
        setCopied(false)
    }, [currentUrl])    

    useEffect(() => {
        const handleClickOutside = ({ target }) => {
            if (!drawerRef.current?.contains(target)) {
                setDrawerOpened(false);
            }
        };
        document.addEventListener("mousedown", handleClickOutside);
        return () => document.removeEventListener("mousedown", handleClickOutside);
    }, []);


    return (
        <div ref={drawerRef} className={`drawer-menu ${drawerOpened ? 'active' : ''}`} >
            <div className='head'>
                <h4>
                    <span>Share Page</span>
                    <svg viewBox="0 0 50 50" fill='currentcolor'>
                        <path
                            d="M32.142,19.153c2.717,0,4.927-2.21,4.927-4.926c0-2.717-2.21-4.927-4.927-4.927c-2.716,0-4.926,2.21-4.926,4.927
                                c0,0.639,0.131,1.245,0.354,1.806l-9.786,5.676c-0.893-0.9-2.129-1.459-3.493-1.459c-2.716,0-4.926,2.21-4.926,4.926
                                c0,2.717,2.21,4.927,4.926,4.927c1.385,0,2.634-0.58,3.53-1.504l9.704,6.116c-0.188,0.521-0.308,1.074-0.308,1.659
                                c0,2.716,2.21,4.926,4.926,4.926c2.717,0,4.927-2.21,4.927-4.926c0-2.717-2.21-4.927-4.927-4.927c-1.412,0-2.678,0.605-3.577,1.56
                                l-9.679-6.101c0.204-0.541,0.33-1.12,0.33-1.731c0-0.631-0.13-1.229-0.347-1.784l9.795-5.681
                                C29.555,18.602,30.785,19.153,32.142,19.153z M32.142,33.448c1.614,0,2.927,1.313,2.927,2.927c0,1.613-1.313,2.926-2.927,2.926
                                c-1.613,0-2.926-1.313-2.926-2.926c0-0.538,0.156-1.036,0.41-1.469c0.008-0.011,0.018-0.019,0.026-0.031
                                c0.011-0.017,0.011-0.037,0.021-0.054C30.19,33.999,31.1,33.448,32.142,33.448z M14.29,28.104c-1.613,0-2.926-1.313-2.926-2.927
                                c0-1.613,1.313-2.926,2.926-2.926c0.954,0,1.795,0.466,2.33,1.175c0.014,0.032,0.015,0.066,0.033,0.096
                                c0.047,0.082,0.105,0.153,0.17,0.216c0.243,0.427,0.394,0.913,0.394,1.438c0,0.574-0.172,1.107-0.459,1.559
                                c-0.002,0.003-0.005,0.004-0.007,0.007c-0.004,0.006-0.003,0.012-0.007,0.018C16.221,27.567,15.319,28.104,14.29,28.104z
                                M32.142,11.301c1.614,0,2.927,1.313,2.927,2.927c0,1.613-1.313,2.926-2.927,2.926c-1.613,0-2.926-1.313-2.926-2.926
                                C29.216,12.613,30.528,11.301,32.142,11.301z"
                        />
                    </svg>
                </h4>
                <button className='btn close-btn' onClick={() => setDrawerOpened(false)} >
                    <img src={CrossIcon} alt='' style={{ width: '20px' }} />
                </button>
            </div>
            <div className='drawer-content'>
                <div className='social-icons'>
                    <a className='icon-holder' href={`https://www.facebook.com/sharer/sharer.php?u=${currentUrl}`} target='_blank'>
                        <svg viewBox="0 0 52 53">
                            <path d="M52.0001 27.158C52.0001 12.7102 40.5827 0.998047 26.4986 0.998047C12.4145 0.998047 0.99707 12.7102 0.99707 27.158C0.99707 40.2151 10.3226 51.0376 22.514 53.0001V34.7198H16.039V27.158H22.514V21.3946C22.514 14.8383 26.3212 11.2168 32.1463 11.2168C34.9363 11.2168 37.8547 11.7277 37.8547 11.7277V18.1655H34.639C31.4711 18.1655 30.4832 20.182 30.4832 22.2508V27.158H37.5559L36.4252 34.7198H30.4832V53.0001C42.6745 51.0376 52.0001 40.2151 52.0001 27.158Z" fill="url(#paint0_linear_801_1264)" id="id_101"></path>
                            <defs>
                                <linearGradient id="paint0_linear_801_1264" x1="26.4986" y1="0.998047" x2="26.4986" y2="53.0001" gradientUnits="userSpaceOnUse">
                                    <stop stop-color="#00279c" id="id_102"></stop>
                                    <stop offset="1" stop-color="#0c2c9e" id="id_103"></stop>
                                </linearGradient>
                            </defs>
                        </svg>
                    </a>
                    <a className='icon-holder' href={`https://api.whatsapp.com/send/?text=${currentUrl}`} target='_blank'>
                        <svg version="1.1" x="0px" y="0px" viewBox="0 0 512 512" fill='#40c451'>
                            <g>
                                <path class="st0" d="M255.5895,7.4681c-135.9882,0-246.6193,110.6311-246.6193,246.6178
                                    c0,47.8372,13.5796,93.7824,39.39,133.6586l-37.4639,82.5239c-3.453,7.6089-2.1955,16.5236,3.2249,22.8793
                                    c4.153,4.8687,10.1751,7.5604,16.3867,7.5604c1.8976,0,3.8123-0.2509,5.6956-0.7684l103.2261-28.3211
                                    c35.6362,19.0584,75.6008,29.0895,116.1599,29.0895c135.9867,0,246.6207-110.6339,246.6207-246.6221
                                    C502.2101,118.0992,391.5762,7.4681,255.5895,7.4681z M255.5895,457.6355c-36.0183,0-71.4592-9.582-102.489-27.7137
                                    c-3.3261-1.9432-7.0813-2.9398-10.8637-2.9398c-1.9104,0-3.8265,0.2552-5.6984,0.7684l-67.4345,18.501l23.488-51.7421
                                    c3.1921-7.0357,2.3738-15.2391-2.1456-21.5021c-25.1247-34.825-38.4034-75.9444-38.4034-118.9214
                                    c0-112.2364,91.3103-203.5467,203.5467-203.5467c112.2378,0,203.5481,91.3103,203.5481,203.5467
                                    C459.1376,366.3237,367.8273,457.6355,255.5895,457.6355z"/>
                            </g>
                            <g>
                                <path class="st0" d="M350.407,291.0181c-10.329-6.1775-23.7689-13.0749-35.9356-8.0964
                                    c-9.3325,3.8194-15.2932,18.4312-21.3395,25.8932c-3.1065,3.8294-6.8105,4.4282-11.5765,2.5092
                                    c-35.0389-13.9574-61.8915-37.3499-81.2265-69.5787c-3.2748-5.0098-2.6874-8.959,1.2603-13.6038
                                    c5.8439-6.8746,13.1761-14.6845,14.7558-23.9556c1.5797-9.2669-2.7658-20.1035-6.598-28.3553
                                    c-4.8958-10.5457-10.3704-25.5852-20.9318-31.5502c-9.7146-5.486-22.5029-2.4151-31.1553,4.6306
                                    c-14.9325,12.161-22.1365,31.2123-21.9212,50.0997c0.0613,5.3663,0.7214,10.7182,1.9746,15.8977
                                    c3.0125,12.4576,8.7693,24.0882,15.2505,35.1486c4.8844,8.3374,10.1936,16.4295,15.922,24.2108
                                    c18.7434,25.4612,42.0603,47.5862,69.0569,64.1212c13.4898,8.2618,28.0203,15.5085,43.0654,20.4784
                                    c16.8743,5.5744,31.9095,11.3798,50.1296,7.9182c19.0784-3.6227,37.8845-15.4287,45.4563-33.8142
                                    c2.2397-5.4404,3.3646-11.5038,2.11-17.2521C376.1105,303.8335,360.0203,296.7678,350.407,291.0181z"/>
                            </g>
                        </svg>
                    </a>
                </div>
                <div className='copy-url'>
                    <input value={currentUrl} type='text' />
                    <button onClick={copyLink} className='btn copy-btn'>{copied === true ? "Link Copied" : 'Copy Link'}</button>
                </div>
            </div>
        </div>
    );
};

export default DrawerMenu;